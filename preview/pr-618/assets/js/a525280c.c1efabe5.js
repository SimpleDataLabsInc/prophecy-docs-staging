"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[77467],{13966:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"administration/fabrics/Spark-fabrics/databricks/whitelist-plibs","title":"Add Prophecy libraries to allowlist for UC standard clusters","description":"Make ProphecyLibs available to Databricks UC standard clusters","source":"@site/docs/administration/fabrics/Spark-fabrics/databricks/whitelist-plibs.md","sourceDirName":"administration/fabrics/Spark-fabrics/databricks","slug":"/engineers/dbx-whitelist-plibs","permalink":"/prophecy-docs-staging/preview/pr-618/engineers/dbx-whitelist-plibs","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"unity catalog","permalink":"/prophecy-docs-staging/preview/pr-618/tags/unity-catalog"},{"inline":true,"label":"databricks","permalink":"/prophecy-docs-staging/preview/pr-618/tags/databricks"},{"inline":true,"label":"plibs","permalink":"/prophecy-docs-staging/preview/pr-618/tags/plibs"}],"version":"current","frontMatter":{"title":"Add Prophecy libraries to allowlist for UC standard clusters","sidebar_label":"Allowlist ProphecyLibs","id":"whitelist-plibs","slug":"/engineers/dbx-whitelist-plibs","description":"Make ProphecyLibs available to Databricks UC standard clusters","tags":["unity catalog","databricks","plibs"]},"sidebar":"adminSidebar","previous":{"title":"UC standard cluster support","permalink":"/prophecy-docs-staging/preview/pr-618/administration/fabrics/Spark-fabrics/databricks/ucshared"},"next":{"title":"ProphecyLibs in volumes","permalink":"/prophecy-docs-staging/preview/pr-618/engineers/dbx-volumes-plibs"}}');var s=t(74848),a=t(28453);const r={title:"Add Prophecy libraries to allowlist for UC standard clusters",sidebar_label:"Allowlist ProphecyLibs",id:"whitelist-plibs",slug:"/engineers/dbx-whitelist-plibs",description:"Make ProphecyLibs available to Databricks UC standard clusters",tags:["unity catalog","databricks","plibs"]},o=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Option 1: Edit allowlist in the Databricks UI",id:"option-1-edit-allowlist-in-the-databricks-ui",level:2},{value:"Option 2: Edit allowlist via Python Notebook",id:"option-2-edit-allowlist-via-python-notebook",level:2},{value:"Option 3: Edit allowlist via cURL",id:"option-3-edit-allowlist-via-curl",level:2},{value:"Prophecy library Maven coordinate",id:"prophecy-library-maven-coordinate",level:3},{value:"Volume path for JARs",id:"volume-path-for-jars",level:3}];function d(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.p,{children:["To use ",(0,s.jsx)(i.a,{href:"/engineers/prophecy-libraries",children:"Prophecy libraries"})," in Databricks environments that have enabled Unity Catalog, you must whitelist the required Maven coordinates or JAR paths. This page outlines different ways to do so."]}),"\n",(0,s.jsx)(i.admonition,{type:"info",children:(0,s.jsxs)(i.p,{children:["For more information, see the Databricks documentation on ",(0,s.jsx)(i.a,{href:"https://docs.databricks.com/aws/en/data-governance/unity-catalog/manage-privileges/allowlist",children:"allowlists"}),"."]})}),"\n",(0,s.jsx)(i.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(i.p,{children:["To whitelist Prophecy libraries in Databricks, you need to be a ",(0,s.jsx)(i.a,{href:"https://docs.databricks.com/aws/en/data-governance/unity-catalog/manage-privileges/admin-privileges#metastore-admins",children:"Databricks metastore admin"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"option-1-edit-allowlist-in-the-databricks-ui",children:"Option 1: Edit allowlist in the Databricks UI"}),"\n",(0,s.jsx)(i.p,{children:"Follow the instructions to whitelist Prophecy libraries through the Databricks UI."}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Check your Prophecy Library version"})}),"\n",(0,s.jsxs)(i.p,{children:["Find your project's Prophecy library version by checking the ProphecyLibs dependency in your ",(0,s.jsx)(i.a,{href:"/projects#metadata",children:"project metadata"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Check your cluster's Spark version"})}),"\n",(0,s.jsx)(i.p,{children:"Note the Spark version used by your Databricks cluster."}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Copy the corresponding Maven coordinate"})}),"\n",(0,s.jsxs)(i.p,{children:["Format: ",(0,s.jsx)(i.code,{children:"io.prophecy:prophecy-libs_2.12:<version>"})]}),"\n",(0,s.jsxs)(i.p,{children:["Example: ",(0,s.jsx)(i.code,{children:"io.prophecy:prophecy-libs_2.12:3.5.0-8.0.31"})]}),"\n",(0,s.jsx)(i.p,{children:"You can look up versions on Maven Repository that are compatible with your Spark version."}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Navigate to allowlist in Databricks"})}),"\n",(0,s.jsxs)(i.p,{children:["Go to ",(0,s.jsx)(i.strong,{children:"Catalog \u2192 Metastore \u2192 Allowed JARs/Init Scripts"})," to add the path/coordinates."]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Databricks allow list",src:t(16805).A+"",width:"1916",height:"1156"})}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"(Optional) Add initialization script"})}),"\n",(0,s.jsxs)(i.p,{children:["You can also use the ",(0,s.jsx)(i.strong,{children:"Init Script"})," option to pre-configure allowlist behavior."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"option-2-edit-allowlist-via-python-notebook",children:"Option 2: Edit allowlist via Python Notebook"}),"\n",(0,s.jsxs)(i.p,{children:["Use the following Python code in a Databricks notebook to whitelist the Prophecy library Maven coordinates. This command whitelists any Maven coordinates that begin with ",(0,s.jsx)(i.code,{children:"io.prophecy"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",children:'import requests\n\nurl = "https://<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_MAVEN"\nheaders = {\n    "Content-Type": "application/json",\n    "Authorization": "Bearer <your-token>",  # Replace with your PAT\n}\ndata = {\n    "artifact_matchers": [\n        {\n            "artifact": "io.prophecy",\n            "match_type": "PREFIX_MATCH"\n        }\n    ]\n}\n\nresponse = requests.put(url, headers=headers, json=data)\n\nprint(f"Status Code: {response.status_code}")\nprint(f"Response Text: {response.text}")\n'})}),"\n",(0,s.jsx)(i.h2,{id:"option-3-edit-allowlist-via-curl",children:"Option 3: Edit allowlist via cURL"}),"\n",(0,s.jsx)(i.h3,{id:"prophecy-library-maven-coordinate",children:"Prophecy library Maven coordinate"}),"\n",(0,s.jsxs)(i.p,{children:["Run the following in the command line to whitelist the Prophecy library Maven coordinates. This command whitelists any Maven coordinates that begin with ",(0,s.jsx)(i.code,{children:"io.prophecy"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:'curl -v --location --request PUT \'<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_MAVEN\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer <your-token>\' \\\n--data \'{\n  "artifact_matchers": [\n    {\n      "artifact": "io.prophecy",\n      "match_type": "PREFIX_MATCH"\n    }\n  ]\n}\'\n'})}),"\n",(0,s.jsx)(i.h3,{id:"volume-path-for-jars",children:"Volume path for JARs"}),"\n",(0,s.jsxs)(i.p,{children:["Run the following in the command line to whitelist a volume path for JARs. This is relevant if you have ",(0,s.jsx)(i.a,{href:"/engineers/dbx-volumes-plibs",children:"set up Prophecy libraries in a Databricks volume"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:'curl -v --location --request PUT \'<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_JAR\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer <your-token>\' \\\n--data \'{\n  "artifact_matchers": [\n    {\n      "artifact": "/Volumes/shared-libs/",\n      "match_type": "PREFIX_MATCH"\n    }\n  ]\n}\'\n'})})]})}function p(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},16805:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/dbx-allowlist-e7cd487f3608a296030a927734747a07.png"},28453:(e,i,t)=>{t.d(i,{R:()=>r,x:()=>o});var n=t(96540);const s={},a=n.createContext(s);function r(e){const i=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:i},e.children)}}}]);